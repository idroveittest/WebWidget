let IDroveItWidgetSettings={dealerId:"",apiSecretKey:"",appendWidgetToParent:"",widgetStylesHref:"",vin:""};const iDroveItWebWidget=widgetData=>{let jQuery,divResult="<div id='i-drove-it-web-widget'><div id='i-drove-it-web-widget-error'></div><div id='web-widget-dynamic-price'></div><div id='web-widget-competitive-dealers'><ul  class='web-widget-ul' id='web-widget-competitive-dealers-list'></ul></div><div id='web-widget-reviews'><ul id='web-widget-reviews-list' class='web-widget-ul'></ul></div></div>";if(void 0===window.jQuery){let script_tag=document.createElement("script");script_tag.setAttribute("type","text/javascript"),script_tag.setAttribute("src","https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"),script_tag.readyState?script_tag.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||scriptLoadHandler()}:script_tag.onload=scriptLoadHandler,(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(script_tag)}else jQuery=window.jQuery,loadCss(),main();function loadCss(){if(jQuery(`${widgetData.appendWidgetToParent}`).append(divResult),""!==widgetData.widgetStylesHref){jQuery("#defaultStyle").remove(),jQuery("<link>",{rel:"stylesheet",type:"text/css",href:widgetData.widgetStylesHref}).appendTo("head")}}function scriptLoadHandler(){jQuery=window.jQuery.noConflict(!0),loadCss(),main()}function getReviews(){const api_url=`https://idrove.it/api/v1/reviews?dealerKey=${widgetData.dealerId}`;jQuery.ajax({url:api_url,method:"GET",headers:{Authorization:widgetData.apiSecretKey,"Content-Type":"application/json",Accept:"application/json"},success:function(response){!function(...reviews){reviews.forEach(review=>{if(review&&review.googleReview){const rating=review.rating.toString(),numOfStars=parseInt(rating.substring(0,1)),dotIndex=rating.indexOf("."),reviewProvider=review.url.includes("google")?"Google reviews":"Yelp reviews",reviewsFrom=reviewProvider.replace(" ","-");switch(numOfStars){case 0:jQuery("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${reviewsFrom}"></li>`);break;case 1:jQuery("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${reviewsFrom}">★ </li>`);break;case 2:jQuery("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${reviewsFrom}">★★ </li>`);break;case 3:jQuery("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${reviewsFrom}">★★★ </li>`);break;case 4:jQuery("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${reviewsFrom}">★★★★ </li>`);break;case 5:jQuery("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${reviewsFrom}">★★★★★ </li>`)}if(-1!==dotIndex){const afterDecimal=parseInt(rating.substring(2));afterDecimal>4&&jQuery(`#web-widget-stars-${reviewsFrom}`).append("<span>½ </span>")}rating>0&&rating<6&&jQuery(`#web-widget-stars-${reviewsFrom}`).append(`<span id="web-widget-number-rating">${rating} ( <a id="web-widget-reviews-url" href='${review.url}'>${reviewProvider}</a> )</span>`)}})}(void 0!==response.data.dealerReviews[0]?response.data.dealerReviews[0]:null,void 0!==response.data.dealerReviews[1]?response.data.dealerReviews[1]:null)},error:function(xhr){jQuery("#i-drove-it-web-widget-error").is(":empty")&&jQuery("#i-drove-it-web-widget-error").append('<h4 class="web-widget-error">Request error. Please contact our support team</h4>'),console.log(xhr.status+": "+xhr.statusText)}})}function main(){!function(){const api_url=`https://idrove.it/api/v1/price?dealerKey=${widgetData.dealerId}`;jQuery.ajax({url:api_url,method:"POST",data:JSON.stringify({vins:[{value:widgetData.vin}]}),dataType:"JSON",headers:{"Content-Type":"application/json",Authorization:widgetData.apiSecretKey,Accept:"application/json"},success:function(response){const vehiclePrice=void 0!==response.data[0]?response.data[0].dynamicPrice.toLocaleString():null;null!==vehiclePrice?jQuery("#web-widget-dynamic-price").append(`<h1 id="web-widget-dynamic-price-header"><strong>&#36;</strong><strong>${vehiclePrice}</strong></h1>`):jQuery("#i-drove-it-web-widget-error").append('<h4 class="web-widget-error">Data is not available. Please contact our support team</h4>')},error:function(xhr){jQuery("#i-drove-it-web-widget-error").is(":empty")&&jQuery("#i-drove-it-web-widget-error").append('<h4 class="web-widget-error">Request error. Please contact our support team</h4>'),console.log(xhr.status+": "+xhr.statusText)}})}(),function(){const api_url=`https://idrove.it/api/v1/statistic?dealerKey=${widgetData.dealerId}`;jQuery.ajax({url:api_url,method:"POST",data:JSON.stringify({vins:[{value:widgetData.vin}]}),dataType:"JSON",headers:{"Content-Type":"application/json",Authorization:widgetData.apiSecretKey,Accept:"application/json"},success:function(response){const similarCompetitorVehicles=void 0!==response.data[0]?response.data[0].similarCompetitorVehicles:null;null!==similarCompetitorVehicles&&similarCompetitorVehicles.length>0&&(jQuery("#web-widget-competitive-dealers-list").append('<li id="web-widget-list-header">Compare other dealership prices</li>'),similarCompetitorVehicles.forEach(vehicle=>{jQuery("#web-widget-competitive-dealers-list").append(`<li id="widget-dealer-list"><span id="widget-dealer-name">${vehicle.dealerName}: </span><span id="widget-dealer-price">&#36;${vehicle.price.toLocaleString()}</span></li>`)}))},error:function(xhr){jQuery("#i-drove-it-web-widget-error").is(":empty")&&jQuery("#i-drove-it-web-widget-error").append('<h4 class="web-widget-error">Request error. Please contact our support team</h4>'),console.log(xhr.status+": "+xhr.statusText)}})}(),getReviews()}};