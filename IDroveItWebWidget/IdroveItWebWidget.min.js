let IDroveItWidgetSettings={dealerId:"",apiSecretKey:"",appendWidgetToParent:"",widgetStylesHref:"",vin:""};const iDroveItWebWidget=e=>{let t,i="<div id='i-drove-it-web-widget'><div id='i-drove-it-web-widget-error'></div><div id='web-widget-dynamic-price'></div><div id='web-widget-competitive-dealers'><ul  class='web-widget-ul' id='web-widget-competitive-dealers-list'></ul></div><div id='web-widget-reviews'><ul id='web-widget-reviews-list' class='web-widget-ul'></ul></div></div>";if(void 0===window.jQuery){let e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src","https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"),e.readyState?e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||a()}:e.onload=a,(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(e)}else t=window.jQuery,s(),d();function s(){let s;t(`${e.appendWidgetToParent}`).append(i),(s=""!==e.widgetStylesHref?t("<link>",{rel:"stylesheet",type:"text/css",href:e.widgetStylesHref}):t("<link>",{rel:"stylesheet",type:"text/css",href:"https://cdn.jsdelivr.net/gh/idroveittest/WebWidget/WebWidgetStyles/widgetStyle.min.css"})).appendTo("head")}function a(){t=window.jQuery.noConflict(!0),s(),d()}function r(){const i=`https://idrove.it/api/v1/reviews?dealerKey=${e.dealerId}`;t.ajax({url:i,method:"GET",headers:{Authorization:e.apiSecretKey,"Content-Type":"application/json",Accept:"application/json"},success:function(e){!function(...e){e.forEach(e=>{if(e&&e.googleReview){const i=e.rating.toString(),s=parseInt(i.substring(0,1)),a=i.indexOf("."),r=e.url.includes("google")?"Google reviews":"Yelp reviews",d=r.replace(" ","-");switch(s){case 0:t("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${d}"></li>`);break;case 1:t("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${d}">★ </li>`);break;case 2:t("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${d}">★★ </li>`);break;case 3:t("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${d}">★★★ </li>`);break;case 4:t("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${d}">★★★★ </li>`);break;case 5:t("#web-widget-reviews-list").append(`<li class='web-widget-stars' id="web-widget-stars-${d}">★★★★★ </li>`)}if(-1!==a){const e=parseInt(i.substring(2));e>4&&t(`#web-widget-stars-${d}`).append("<span>½ </span>")}i>0&&i<6&&t(`#web-widget-stars-${d}`).append(`<span id="web-widget-number-rating">${i} ( <a id="web-widget-reviews-url" href='${e.url}'>${r}</a> )</span>`)}})}(void 0!==e.data.dealerReviews[0]?e.data.dealerReviews[0]:null,void 0!==e.data.dealerReviews[1]?e.data.dealerReviews[1]:null)},error:function(e){t("#i-drove-it-web-widget-error").is(":empty")&&t("#i-drove-it-web-widget-error").append('<h4 class="web-widget-error">Request error. Please contact our support team</h4>'),console.log(e.status+": "+e.statusText)}})}function d(){!function(){const i=`https://idrove.it/api/v1/price?dealerKey=${e.dealerId}`;t.ajax({url:i,method:"POST",data:JSON.stringify({vins:[{value:e.vin}]}),dataType:"JSON",headers:{"Content-Type":"application/json",Authorization:e.apiSecretKey,Accept:"application/json"},success:function(e){const i=void 0!==e.data[0]?e.data[0].dynamicPrice.toLocaleString():null;null!==i?t("#web-widget-dynamic-price").append(`<h1 id="web-widget-dynamic-price-header"><strong>&#36;</strong><strong>${i}</strong></h1>`):t("#i-drove-it-web-widget-error").append('<h4 class="web-widget-error">Data is not available. Please contact our support team</h4>')},error:function(e){t("#i-drove-it-web-widget-error").is(":empty")&&t("#i-drove-it-web-widget-error").append('<h4 class="web-widget-error">Request error. Please contact our support team</h4>'),console.log(e.status+": "+e.statusText)}})}(),function(){const i=`https://idrove.it/api/v1/statistic?dealerKey=${e.dealerId}`;t.ajax({url:i,method:"POST",data:JSON.stringify({vins:[{value:e.vin}]}),dataType:"JSON",headers:{"Content-Type":"application/json",Authorization:e.apiSecretKey,Accept:"application/json"},success:function(e){const i=void 0!==e.data[0]?e.data[0].similarCompetitorVehicles:null;null!==i&&i.length>0&&(t("#web-widget-competitive-dealers-list").append('<li id="web-widget-list-header">Compare other dealership prices</li>'),i.forEach(e=>{t("#web-widget-competitive-dealers-list").append(`<li id="widget-dealer-list"><span id="widget-dealer-name">${e.dealerName}: </span><span id="widget-dealer-price">&#36;${e.price.toLocaleString()}</span></li>`)}))},error:function(e){t("#i-drove-it-web-widget-error").is(":empty")&&t("#i-drove-it-web-widget-error").append('<h4 class="web-widget-error">Request error. Please contact our support team</h4>'),console.log(e.status+": "+e.statusText)}})}(),r()}};